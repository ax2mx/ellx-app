import test from 'ava';
import { show } from './renderNode.js';
import { STALE, STALE_BUNDLE } from './engine/quack.js';

test('the show function', t => {
  t.is(show(new Error('test')), '#ERR: test');
  t.is(show(STALE), '...');
  t.is(show(STALE_BUNDLE), '...bundling...');
  t.is(show(NaN), 'NaN');
  t.is(show(Infinity), 'Infinity');
  t.is(show(-Infinity), '-Infinity');
});

test('precision for floating point numbers render', t => {
  t.is(show(123456789012), '123456789012');
  t.is(show(-12345678901), '-12345678901');

  t.is(show(1234567890123), '1234567890123');
  t.is(show(-123456789012), '-123456789012');

  t.is(show(-1234567890123), '-1.234568e+12');
  t.is(show(12345678901234), '1.2345679e+13');

  t.is(show(12345679901234), '1.234568e+13');
  t.is(show(-1234567990123), '-1.234568e+12');
  t.is(show(-1234569990123), '-1.23457e+12');

  t.is(show(1.23456789e-13), '1.2345679e-13');
  t.is(show(1.2345678e-13), '1.2345678e-13');
  t.is(show(1.234567e-13), '1.234567e-13');

  t.is(show(-1.2345678e-13), '-1.234568e-13');

  t.is(show(1.23456789e-113), '1.234568e-113');
  t.is(show(-1.23456789e-113), '-1.23457e-113');

  t.is(show(1.234567899e-5), '1.2345679e-5');
  t.is(show(1.234567891e-5), '1.23456789e-5');

  t.is(show(1.234567899e-3), '0.0012345679');
  t.is(show(1.234567891e-3), '0.00123456789');

  t.is(show(1.23456789e+113), '1.234568e+113');
  t.is(show(-1.23456789e+113), '-1.23457e+113');

  t.is(show(1.234567999e-5), '1.234568e-5');
  t.is(show(1.234567999e-3), '0.001234568');

  t.is(show(0.1234567898765), '0.12345678988');
  t.is(show(0.00000123456789), '1.23456789e-6');

  t.is(show(1.23456789e+60), '1.2345679e+60');
  t.is(show(1234567890120.1), '1234567890120');
  t.is(show(1234567890128.1), '1234567890128');
  t.is(show(123456789012.81), '123456789013');
  t.is(show(123456789012.816), '123456789013');
  t.is(show(12345678901.816), '12345678901.8');

  t.is(show(0.99999999999999), '1');
  t.is(show(-0.99999999999999), '-1');

  t.is(show(0.99999999999), '0.99999999999');
  t.is(show(-0.99999999999), '-1');

  t.is(show(0.00000001), '1e-8');
});
